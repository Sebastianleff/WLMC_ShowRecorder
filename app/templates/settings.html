<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Settings</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>

{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <div class="position-fixed top-0 start-50 translate-middle-x mt-3 d-inline-block" style="z-index: 1050; max-width: 90%;">
            {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        </div>
        <script>
            setTimeout(function() {
                var alerts = document.querySelectorAll('.alert');
                alerts.forEach(function(alert) {
                    alert.classList.remove('show');
                });
            }, 2500);
        </script>
    {% endif %}
{% endwith %}

<div class="container mt-5">
    <h2>Settings</h2>
    <form method="post">
        <!-- Admin Username Field -->
        <div class="mb-3">
            <label for="admin_username" class="form-label">
                Admin Username
                <i class="bi bi-info-circle-fill ms-1" data-bs-toggle="tooltip" title="The username used to log in as an admin."></i>
            </label>
            <input type="text" name="admin_username" id="admin_username" class="form-control" value="{{ admin_username }}" required>
        </div>
        
        <!-- Admin Password Field -->
        <div class="mb-3">
            <label for="admin_password" class="form-label">
                Admin Password
                <i class="bi bi-info-circle-fill ms-1" data-bs-toggle="tooltip" title="The password for admin access. Keep this secure."></i>
            </label>
            <div class="input-group">
                <input type="password" name="admin_password" id="admin_password" class="form-control" value="{{ admin_password }}" required>
                <button type="button" class="btn btn-outline-secondary" onclick="togglePassword()">Show/Hide</button>
            </div>
        </div>
        
        <!-- Stream URL Field -->
        <div class="mb-3">
            <label for="stream_url" class="form-label">
                Stream URL
                <i class="bi bi-info-circle-fill ms-1" data-bs-toggle="tooltip" title="The URL of the stream to be recorded."></i>
            </label>
            <input type="text" name="stream_url" id="stream_url" class="form-control" value="{{ stream_url }}" required>
        </div>
        
        <!-- Output Folder Field -->
        <div class="mb-3">
            <label for="output_folder" class="form-label">
                Output Folder
                <i class="bi bi-info-circle-fill ms-1" data-bs-toggle="tooltip" title="The folder where recordings will be saved."></i>
            </label>
            <input type="text" name="output_folder" id="output_folder" class="form-control" value="{{ output_folder }}" required>
        </div>
        
        {% comment %} <!-- Custom Semester Toggle -->
        <div class="form-check mb-3">
            <input type="checkbox" name="use_custom_semesters" class="form-check-input" id="useCustomSemesters" {% if use_custom_semesters %}checked{% endif %} onchange="toggleCustomSemesterFields()">
            <label class="form-check-label" for="useCustomSemesters">
                Enable Custom Semesters
                <i class="bi bi-info-circle-fill ms-1" data-bs-toggle="tooltip" title="This feature is currently in development and is not yet implmented."></i>
            </label>
        </div>
        

        <!-- Custom Semester Fields (Hidden by Default) -->
        <div id="customSemesterFields" style="display: none;">
            <div class="mb-3">
                <label for="custom_semester_1_start" class="form-label">Custom Semester 1 Start Date</label>
                <input type="date" name="custom_semester_1_start" class="form-control" value="{{ custom_semester_1_start }}">
            </div>
            <div class="mb-3">
                <label for="custom_semester_1_end" class="form-label">Custom Semester 1 End Date</label>
                <input type="date" name="custom_semester_1_end" class="form-control" value="{{ custom_semester_1_end }}">
            </div>
            <div class="mb-3">
                <label for="custom_semester_2_start" class="form-label">Custom Semester 2 Start Date</label>
                <input type="date" name="custom_semester_2_start" class="form-control" value="{{ custom_semester_2_start }}">
            </div>
            <div class="mb-3">
                <label for="custom_semester_2_end" class="form-label">Custom Semester 2 End Date</label>
                <input type="date" name="custom_semester_2_end" class="form-control" value="{{ custom_semester_2_end }}">
            </div>
        </div> {% endcomment %}
        
        <button type="submit" class="btn btn-primary">Save Settings</button>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        });
        toggleCustomSemesterFields(); // Set initial visibility of custom semester fields on page load
    });

    function togglePassword() {
        const passwordInput = document.getElementById("admin_password");
        passwordInput.type = passwordInput.type === "password" ? "text" : "password";
    }

    {% comment %} function toggleCustomSemesterFields() {
        const customSemesterFields = document.getElementById("customSemesterFields");
        const useCustomSemesters = document.getElementById("useCustomSemesters").checked;
        customSemesterFields.style.display = useCustomSemesters ? "block" : "none";
    } {% endcomment %}
</script>
</body>
</html>
